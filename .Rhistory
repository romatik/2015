as.data.frame(items28)
alpha(as.data.frame(items28))
View(items28)
litems28 <- likert(items28)
plot(litems28)
apply(items28, 2, function(x) gsub("NA", NA, x))
alpha(as.data.frame(items28))
items28 <- apply(items28, 2, function(x) gsub("NA", NA, x))
alpha(as.data.frame(items28))
View(items28)
items28 <- pisaitems[, substr(names(pisaitems), 1, 5) == "ST24Q"]
items28 <- data.matrix(items28)
View(items28)
alpha(as.data.frame(items28))
alpha(items28)
library(likert)
data(pisaitems)
items24 <- pisaitems[, substr(names(pisaitems), 1, 5) == "ST24Q"]
items24 <- rename(items24, c(ST24Q01 = "I read only if I have to.", ST24Q02 = "Reading is one of my favorite hobbies.",
ST24Q03 = "I like talking about books with other people.", ST24Q04 = "I find it hard to finish books.", ST24Q05 = "I feel happy if I receive a book as a present.",
ST24Q06 = "For me, reading is a waste of time.", ST24Q07 = "I enjoy going to a bookstore or a library.", ST24Q08 = "I read only to get information that I need.",
ST24Q09 = "I cannot sit still and read for more than a few minutes.", ST24Q10 = "I like to express my opinions about books I have read.",
ST24Q11 = "I like to exchange books with my friends"))
?rename
??rename
library(plyr)
items24 <- rename(items24, c(ST24Q01 = "I read only if I have to.", ST24Q02 = "Reading is one of my favorite hobbies.",
ST24Q03 = "I like talking about books with other people.", ST24Q04 = "I find it hard to finish books.", ST24Q05 = "I feel happy if I receive a book as a present.",
ST24Q06 = "For me, reading is a waste of time.", ST24Q07 = "I enjoy going to a bookstore or a library.", ST24Q08 = "I read only to get information that I need.",
ST24Q09 = "I cannot sit still and read for more than a few minutes.", ST24Q10 = "I like to express my opinions about books I have read.",
ST24Q11 = "I like to exchange books with my friends"))
items28 <- pisaitems[, substr(names(pisaitems), 1, 5) == "ST24Q"]
items28 <- data.matrix(items28)
items28 <- rename(items28, c(ST24Q01 = "I read only if I have to.", ST24Q02 = "Reading is one of my favorite hobbies.",
ST24Q03 = "I like talking about books with other people.", ST24Q04 = "I find it hard to finish books.", ST24Q05 = "I feel happy if I receive a book as a present.",
ST24Q06 = "For me, reading is a waste of time.", ST24Q07 = "I enjoy going to a bookstore or a library.", ST24Q08 = "I read only to get information that I need.",
ST24Q09 = "I cannot sit still and read for more than a few minutes.", ST24Q10 = "I like to express my opinions about books I have read.",
ST24Q11 = "I like to exchange books with my friends"))
View(items28)
items28 <- pisaitems[, substr(names(pisaitems), 1, 5) == "ST24Q"]
items28 <- rename(items28, c(ST24Q01 = "I read only if I have to.", ST24Q02 = "Reading is one of my favorite hobbies.",
ST24Q03 = "I like talking about books with other people.", ST24Q04 = "I find it hard to finish books.", ST24Q05 = "I feel happy if I receive a book as a present.",
ST24Q06 = "For me, reading is a waste of time.", ST24Q07 = "I enjoy going to a bookstore or a library.", ST24Q08 = "I read only to get information that I need.",
ST24Q09 = "I cannot sit still and read for more than a few minutes.", ST24Q10 = "I like to express my opinions about books I have read.",
ST24Q11 = "I like to exchange books with my friends"))
items28 <- data.matrix(items28)
View(items28)
alpha(items28)
library(psych)
alpha(items28)
clr()
clear()
library(likert)
library(plyr)
library(psych)
library(plotrix)
library(plyr)
library(reshape)
library(latticeExtra)
library(openintro)
library(swirl)
mydata <- read.csv("C:/Users/Misha/Dropbox/Projects/EM Internship/Quantitative analyst data sheet (round 2).csv", na.strings=c("N/A", "", " "))
View(mydata)
mydata <- within(mydata, X1.1.1 <- factor(X1.1.1, labels = sprintf("Course %d", 1:length(unique(mydata$X1.1.1)))))
View(mydata)
boxplot(mydata$X1.5.3~mydata$X1.5.4)
boxplot(mydata$X1.5.3~mydata$X4.1.1)
Course15 <- subset(mydata, X1.1.1 == "Course 15", select = X4.1.2)
summary(Course15)
plot(Course15, main = "Answers for question 4.1.2 from the Course 15")
sd(mydata$X1.5.3)
sd(mydata$X1.5.3, na.rm=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
mean(mydata$X1.5.3)
summary(mydata$X1.5.3)
feedback <- cast(mydata, X1.1.1 ~ X4.6) #reshaping the data to have table with each course and answers to the question 4.6
feedback$relative <- (feedback$No)/max(feedback$No) - feedback$Yes/max(feedback$Yes) # the higher number in a new column - the more people said that the course didn't implement the feedback from the students
head(feedback[order(-feedback$relative),], n=20) #ordering by relative column
feedback$relative <- (feedback$No)/(feedback$No + feedback$Yes) # the higher number in a new column - the more people said that the course didn't implement the feedback from the students
head(feedback[order(-feedback$relative),], n = 20) #ordering by relative column
xyplot(window(sunspot.year, start = 1900),
main = "Sunspot cycles", sub = "Number per year",
par.settings = theEconomist.theme(box = "transparent"),
lattice.options = theEconomist.opts())
data(pisaitems)
items24 <- pisaitems[, substr(names(pisaitems), 1, 5) == "ST24Q"]
head(items24)
items24 <- rename(items24, c(ST24Q01 = "I read only if I have to.", ST24Q02 = "Reading is one of my favorite hobbies.",
ST24Q03 = "I like talking about books with other people.", ST24Q04 = "I find it hard to finish books.", ST24Q05 = "I feel happy if I receive a book as a present.",
ST24Q06 = "For me, reading is a waste of time.", ST24Q07 = "I enjoy going to a bookstore or a library.", ST24Q08 = "I read only to get information that I need.",
ST24Q09 = "I cannot sit still and read for more than a few minutes.", ST24Q10 = "I like to express my opinions about books I have read.",
ST24Q11 = "I like to exchange books with my friends"))
l24 <- likert(items24)
summary(l24)
plot(l24)
plot(l24, centered = FALSE, wrap = 30)
plot(l24, type = "density")
plot(l24, type = "heat")
items28 <- pisaitems[, substr(names(pisaitems), 1, 5) == "ST24Q"]
items28 <- rename(items28, c(ST24Q01 = "I read only if I have to.", ST24Q02 = "Reading is one of my favorite hobbies.",
ST24Q03 = "I like talking about books with other people.", ST24Q04 = "I find it hard to finish books.", ST24Q05 = "I feel happy if I receive a book as a present.",
ST24Q06 = "For me, reading is a waste of time.", ST24Q07 = "I enjoy going to a bookstore or a library.", ST24Q08 = "I read only to get information that I need.",
ST24Q09 = "I cannot sit still and read for more than a few minutes.", ST24Q10 = "I like to express my opinions about books I have read.",
ST24Q11 = "I like to exchange books with my friends"))
items28 <- data.matrix(items28)
alpha(items28)
study <- c(1:13)
corr  <- c(.12,.54,-.52,.21,-.24,.34,.41,.58,-.03,.38,.42,.61,.90)
low   <- c(.09,.51,-.57,.19,-.26,.30,.39,.56,-.07,.35,.40,.58,.87)
high  <- c(.15,.58,-.50,.24,-.22,.37,.44,.60, .00,.41,.44,.63,.91)
group <- c("a","b", "a","a", "b","a","a","a", "b","a","a","a","a")
correlations <- data.frame(study,corr,low,high,group)
cbPalette <- c("#000000", "#DD0000")
forestplot <- ggplot(data=correlations, aes(x=study, y=corr, ymin=low, ymax=high, colour=group)) +
geom_hline(aes(yintercept=0), color="#FFFF99") +
geom_pointrange() +
coord_flip() +
geom_errorbar(aes(ymin= low, ymax= high), width=.2) +
theme(axis.title.x = element_text(face="bold"),
axis.title.y = element_text(face="bold"),
axis.text.x  = element_text(colour="#000000"),
axis.text.y  = element_text(colour="#000000"),
legend.position = "none"
) +
scale_x_continuous("Study",breaks=c(1:13),
labels=c("Study 1",
"Study 2",
"Study 3",
"Study 4",
"Study 5",
"Study 6",
"Study 7",
"Study 8",
"Study 9",
"Study 10",
"Study 11",
"Study 12",
"Study 13"
)
) +
scale_y_continuous("Observed Correlation", breaks=c(-.6,-.4,-.2,0,.2,.4,.6,.8,1)) +
scale_colour_manual(values=cbPalette) +
geom_text(aes(y=corr+.09, size=1), label = corr)
library(ggplot2)
study <- c(1:13)
corr  <- c(.12,.54,-.52,.21,-.24,.34,.41,.58,-.03,.38,.42,.61,.90)
low   <- c(.09,.51,-.57,.19,-.26,.30,.39,.56,-.07,.35,.40,.58,.87)
high  <- c(.15,.58,-.50,.24,-.22,.37,.44,.60, .00,.41,.44,.63,.91)
group <- c("a","b", "a","a", "b","a","a","a", "b","a","a","a","a")
correlations <- data.frame(study,corr,low,high,group)
cbPalette <- c("#000000", "#DD0000")
forestplot <- ggplot(data=correlations, aes(x=study, y=corr, ymin=low, ymax=high, colour=group)) +
geom_hline(aes(yintercept=0), color="#FFFF99") +
geom_pointrange() +
coord_flip() +
geom_errorbar(aes(ymin= low, ymax= high), width=.2) +
theme(axis.title.x = element_text(face="bold"),
axis.title.y = element_text(face="bold"),
axis.text.x  = element_text(colour="#000000"),
axis.text.y  = element_text(colour="#000000"),
legend.position = "none"
) +
scale_x_continuous("Study",breaks=c(1:13),
labels=c("Study 1",
"Study 2",
"Study 3",
"Study 4",
"Study 5",
"Study 6",
"Study 7",
"Study 8",
"Study 9",
"Study 10",
"Study 11",
"Study 12",
"Study 13"
)
) +
scale_y_continuous("Observed Correlation", breaks=c(-.6,-.4,-.2,0,.2,.4,.6,.8,1)) +
scale_colour_manual(values=cbPalette) +
geom_text(aes(y=corr+.09, size=1), label = corr)
library(ggplot2)
study <- c(1:13)
corr  <- c(.12,.54,-.52,.21,-.24,.34,.41,.58,-.03,.38,.42,.61,.90)
low   <- c(.09,.51,-.57,.19,-.26,.30,.39,.56,-.07,.35,.40,.58,.87)
high  <- c(.15,.58,-.50,.24,-.22,.37,.44,.60, .00,.41,.44,.63,.91)
group <- c("a","b", "a","a", "b","a","a","a", "b","a","a","a","a")
correlations <- data.frame(study,corr,low,high,group)
cbPalette <- c("#000000", "#DD0000")
forestplot <- ggplot(data=correlations, aes(x=study, y=corr, ymin=low, ymax=high, colour=group)) +
geom_hline(aes(yintercept=0), color="#FFFF99") +
geom_text(data=subset(your.data, group=="the.group"), aes(label=your.label.variable)) +
geom_pointrange() +
coord_flip() +
geom_errorbar(aes(ymin= low, ymax= high), width=.2) +
theme(axis.title.x = element_text(face="bold"),
axis.title.y = element_text(face="bold"),
axis.text.x  = element_text(colour="#000000"),
axis.text.y  = element_text(colour="#000000"),
legend.position = "none"
) +
scale_x_continuous("Study",breaks=c(1:13),
labels=c("Study 1",
"Study 2",
"Study 3",
"Study 4",
"Study 5",
"Study 6",
"Study 7",
"Study 8",
"Study 9",
"Study 10",
"Study 11",
"Study 12",
"Study 13"
)
) +
scale_y_continuous("Observed Correlation", breaks=c(-.6,-.4,-.2,0,.2,.4,.6,.8,1)) +
scale_colour_manual(values=cbPalette) +
geom_text(aes(y=corr+.09, size=1), label = corr)
forestplot <- ggplot(data=correlations, aes(x=study, y=corr, ymin=low, ymax=high, colour=group)) +
geom_hline(aes(yintercept=0), color="#FFFF99") +
#geom_text(data=subset(your.data, group=="the.group"), aes(label=your.label.variable)) +
geom_pointrange() +
coord_flip() +
geom_errorbar(aes(ymin= low, ymax= high), width=.2) +
theme(axis.title.x = element_text(face="bold"),
axis.title.y = element_text(face="bold"),
axis.text.x  = element_text(colour="#000000"),
axis.text.y  = element_text(colour="#000000"),
legend.position = "none"
) +
scale_x_continuous("Study",breaks=c(1:13),
labels=c("Study 1",
"Study 2",
"Study 3",
"Study 4",
"Study 5",
"Study 6",
"Study 7",
"Study 8",
"Study 9",
"Study 10",
"Study 11",
"Study 12",
"Study 13"
)
) +
scale_y_continuous("Observed Correlation", breaks=c(-.6,-.4,-.2,0,.2,.4,.6,.8,1)) +
scale_colour_manual(values=cbPalette) +
geom_text(aes(y=corr+.09, size=1), label = corr)
forestplot
forestplot <- ggplot(data=correlations, aes(x=study, y=corr, ymin=low, ymax=high, colour=group)) +
geom_hline(aes(yintercept=0), color="#FFFF99") +
geom_text(data=subset(correlations, group=="b"), aes(y=corr+.09, size=1, label = corr)) +
geom_pointrange() +
coord_flip() +
geom_errorbar(aes(ymin= low, ymax= high), width=.2) +
theme(axis.title.x = element_text(face="bold"),
axis.title.y = element_text(face="bold"),
axis.text.x  = element_text(colour="#000000"),
axis.text.y  = element_text(colour="#000000"),
legend.position = "none"
) +
scale_x_continuous("Study",breaks=c(1:13),
labels=c("Study 1",
"Study 2",
"Study 3",
"Study 4",
"Study 5",
"Study 6",
"Study 7",
"Study 8",
"Study 9",
"Study 10",
"Study 11",
"Study 12",
"Study 13"
)
) +
scale_y_continuous("Observed Correlation", breaks=c(-.6,-.4,-.2,0,.2,.4,.6,.8,1)) +
scale_colour_manual(values=cbPalette) +
geom_text(aes(y=corr+.09, size=1), label = corr)
forestplot
library(openintro)
data(cars)
data(petals)
library(ggplot2)
study <- c(1:13)
corr  <- c(.12,.54,-.52,.21,-.24,.34,.41,.58,-.03,.38,.42,.61,.90)
low   <- c(.09,.51,-.57,.19,-.26,.30,.39,.56,-.07,.35,.40,.58,.87)
high  <- c(.15,.58,-.50,.24,-.22,.37,.44,.60, .00,.41,.44,.63,.91)
group <- c("a","b", "a","a", "b","a","a","a", "b","a","a","a","a")
correlations <- data.frame(study,corr,low,high,group)
cbPalette <- c("#000000", "#DD0000")
forestplot <- ggplot(data=correlations, aes(x=study, y=corr, ymin=low, ymax=high, colour=group)) +
geom_hline(aes(yintercept=0), color="#FFFF99") +
geom_text(data=subset(correlations, group=="b"), aes(y=corr+.09, size=1, label = corr)) +
geom_pointrange() +
coord_flip() +
geom_errorbar(aes(ymin= low, ymax= high), width=.2) +
theme(axis.title.x = element_text(face="bold"),
axis.title.y = element_text(face="bold"),
axis.text.x  = element_text(colour="#000000"),
axis.text.y  = element_text(colour="#000000"),
legend.position = "none"
) +
scale_x_continuous("Study",breaks=c(1:13),
labels=c("Study 1",
"Study 2",
"Study 3",
"Study 4",
"Study 5",
"Study 6",
"Study 7",
"Study 8",
"Study 9",
"Study 10",
"Study 11",
"Study 12",
"Study 13"
)
) +
scale_y_continuous("Observed Correlation", breaks=c(-.6,-.4,-.2,0,.2,.4,.6,.8,1)) +
scale_colour_manual(values=cbPalette) +
geom_text(aes(y=corr+.09, size=1), label = corr)
forestplot()
forestplot
install.packages(c("aplpack", "caTools", "digest", "formatR", "highr", "Hmisc", "htmltools", "httr", "jsonlite", "knitr", "labeling", "manipulate", "markdown", "mime", "plotrix", "quantreg", "RColorBrewer", "Rcpp", "RCurl", "reshape2", "rgl", "rmarkdown", "SparseM", "swirl", "testthat", "UsingR"))
library(sqldf)
install.packages("sqldf")
library(sqldf)
data(titanic3, package="PASWR")
colnames(titanic3)
head(titanic3)
install.packages("PASWR")
data(titanic3, package="PASWR")
colnames(titanic3)
head(titanic3)
View(titanic3)
View(titanic3)
sqldf('select age, count(*) from titanic3 where age is not null group by age')
library(ggplot2)
DF=sqldf('select age from titanic3 where age != "NA"')
qplot(DF$age,data=DF, geom="histogram")
DF=sqldf('select count(*) total from titanic3 where age=29 group by survived')
DF2=t(DF)
colnames(DF2)=c('Died','Survived')
DF2
updateR()
?update
library(installr)
updateR()
install.packages("viridis") # dependency
devtools::install_github("ropensci/plotly")
library(dplyr)
library(likert)
library(scales)
library(psych)
library(reshape)
library(grid)
library(RColorBrewer)
dataset <- read.csv("../Media/2015/Master_tables/bigtable.csv", na.strings = c("", " ", "No answer", "N/A", "NA"), header = TRUE)
dataset$X <- NULL
dataset$B.2.2.Rate.the.support.received.on.the.following.issues._Inappropriate.conduct.or.sexual.harassment.issues <- NULL
dataset$B.2.2.a.If.you.feel.comfortable.describe.any.inappropriate.conduct.or.sexual.harassment.issues.you.have.witnessed.or.have.been.the.subject.of.and.the.support.you.have.received.The.answers.to.this.question.will.not.be.shared.with.Erasmus.Mundus.course._Open.Ended.Response <- NULL
setwd("C:/Users/Misha/Dropbox/Projects/EM Internship/Quantitative team/2015")
library(dplyr)
library(likert)
library(scales)
library(psych)
library(reshape)
library(grid)
library(RColorBrewer)
dataset <- read.csv("../Media/2015/Master_tables/bigtable.csv", na.strings = c("", " ", "No answer", "N/A", "NA"), header = TRUE)
dataset$X <- NULL
dataset$B.2.2.Rate.the.support.received.on.the.following.issues._Inappropriate.conduct.or.sexual.harassment.issues <- NULL
dataset$B.2.2.a.If.you.feel.comfortable.describe.any.inappropriate.conduct.or.sexual.harassment.issues.you.have.witnessed.or.have.been.the.subject.of.and.the.support.you.have.received.The.answers.to.this.question.will.not.be.shared.with.Erasmus.Mundus.course._Open.Ended.Response <- NULL
summary(dataset$A.4.Have.you.already.graduated.from.EM.course._Response)
summary(dataset$A.5.When.did.you.start.EM.Course._Response)
summary(as.factor(dataset$A.5.When.did.you.start.EM.Course._Response))
summary(as.factor(dataset$C.4.Please.rate.overall.satisfaction.with.EM.course._))
library(dplyr)
library(likert)
library(scales)
library(psych)
library(reshape)
library(grid)
library(RColorBrewer)
dataset <- read.csv("../Media/2015/Master_tables/bigtable.csv", na.strings = c("", " ", "No answer", "N/A", "NA"), header = TRUE)
dataset$X <- NULL
dataset$B.2.2.Rate.the.support.received.on.the.following.issues._Inappropriate.conduct.or.sexual.harassment.issues <- NULL
dataset$B.2.2.a.If.you.feel.comfortable.describe.any.inappropriate.conduct.or.sexual.harassment.issues.you.have.witnessed.or.have.been.the.subject.of.and.the.support.you.have.received.The.answers.to.this.question.will.not.be.shared.with.Erasmus.Mundus.course._Open.Ended.Response <- NULL
### ordered levels that were used in the survey
likert_levels <- c("Very unsatisfied", "Somewhat unsatisfied", "Somewhat satisfied", "Very satisfied")
agree_levels <- c("Disagree", "Somewhat disagree", "Somewhat agree", "Agree")
z <- dataset %>%
select(starts_with("B.1.1"),
starts_with("B.1.3"),
starts_with("B.2.1"),
starts_with("B.2.2"),
starts_with("C.1"))
for(i in seq_along(z)) {
### this step will also reduce all other answers to NA's
z[,i] <- factor(z[,i], levels = likert_levels)
}
z <- data.matrix(z)
z <- z[complete.cases(z),]
covarainces <- cov(z)
correlations <- cov2cor(covariances)
covariances <- cov(z)
correlations <- cov2cor(covariances)
fa <- fa(correlations, nfactors = 10, rotate = "none", fm = "pa")
fa
fa <- fa(correlations, nfactors = 4, rotate = "none", fm = "pa")
fa
fa <- fa(correlations, nfactors = 4, rotate = "varimax", fm = "pa")
fa
library(likert)
library(scales)
library(psych)
library(reshape)
library(grid)
library(RColorBrewer)
dataset <- read.csv("../Media/2015/Master_tables/bigtable.csv", na.strings = c("", " ", "No answer", "N/A", "NA"), header = TRUE)
dataset$X <- NULL
dataset$B.2.2.Rate.the.support.received.on.the.following.issues._Inappropriate.conduct.or.sexual.harassment.issues <- NULL
dataset$B.2.2.a.If.you.feel.comfortable.describe.any.inappropriate.conduct.or.sexual.harassment.issues.you.have.witnessed.or.have.been.the.subject.of.and.the.support.you.have.received.The.answers.to.this.question.will.not.be.shared.with.Erasmus.Mundus.course._Open.Ended.Response <- NULL
### ordered levels that were used in the survey
likert_levels <- c("Very unsatisfied", "Somewhat unsatisfied", "Somewhat satisfied", "Very satisfied")
agree_levels <- c("Disagree", "Somewhat disagree", "Somewhat agree", "Agree")
z <- dataset %>%
dplyr::select(starts_with("B.1.1"),
starts_with("B.1.3"),
starts_with("B.2.1"),
starts_with("B.2.2"),
starts_with("C.1"),
C.3.Please.rate.academic.satisfaction.with.EM.course._,
C.4.Please.rate.overall.satisfaction.with.EM.course._)
for(i in seq_along(z)) {
### this step will also reduce all other answers to NA's
z[,i] <- factor(z[,i], levels = likert_levels)
}
library(dplyr)
z <- dataset %>%
dplyr::select(starts_with("B.1.1"),
starts_with("B.1.3"),
starts_with("B.2.1"),
starts_with("B.2.2"),
starts_with("C.1"),
C.3.Please.rate.academic.satisfaction.with.EM.course._,
C.4.Please.rate.overall.satisfaction.with.EM.course._)
for(i in seq_along(z)) {
### this step will also reduce all other answers to NA's
z[,i] <- factor(z[,i], levels = likert_levels)
}
View(dataset)
View(z)
colnames(z)[1]
colnames(z) <- gsub("Rate.the.information.and.support.received.before.the.start.of.Erasmus.Mundus.master.course.on.the.following.aspects.", "", colnames(z))
colnames(z)[1]
colnames(z)[10]
colnames(z) <- gsub("Rate.the.introduction.process.to.the.following.units.or.people.as.part.of.the.orientation.program.", "", colnames(z))
View(z)
colnames(z)[15]
colnames(z) <- gsub("Rate.the.helpfulness.of.the.following.units.of.people.", "", colnames(z))
View(z)
colnames(z)[20]
colnames(z)[25]
colnames(z) <- gsub("Rate.the.following.items", "", colnames(z))
colnames(z)[24]
colnames(z) <- gsub("Rate.the.support.received.on.the.following.issues.", "", colnames(z))
View(z)
z <- z[complete.cases(z),]
z <- data.matrix(z)
z[,36] <- as.factor(z[,36])
summary(z[,36])
View(z)
z[,36] <- factor(z[,36])
summary(z[,36])
library(MASS)
library(caTools)
spl <- sample.split(z[,36], SplitRatio = 0.7)
train <- z[spl,]
test <- z[!spl,]
lda.fit <- lda(C.4.Please.rate.overall.satisfaction.with.EM.course._ ~ ., data = train)
likert_levels <- c("Very unsatisfied", "Somewhat unsatisfied", "Somewhat satisfied", "Very satisfied")
agree_levels <- c("Disagree", "Somewhat disagree", "Somewhat agree", "Agree")
z <- dataset %>%
dplyr::select(starts_with("B.1.1"),
starts_with("B.1.3"),
starts_with("B.2.1"),
starts_with("B.2.2"),
starts_with("C.1"),
C.3.Please.rate.academic.satisfaction.with.EM.course._,
C.4.Please.rate.overall.satisfaction.with.EM.course._)
for(i in seq_along(z)) {
### this step will also reduce all other answers to NA's
z[,i] <- factor(z[,i], levels = likert_levels)
}
colnames(z) <- gsub("Rate.the.information.and.support.received.before.the.start.of.Erasmus.Mundus.master.course.on.the.following.aspects.", "", colnames(z))
colnames(z) <- gsub("Rate.the.introduction.process.to.the.following.units.or.people.as.part.of.the.orientation.program.", "", colnames(z))
colnames(z) <- gsub("Rate.the.helpfulness.of.the.following.units.of.people.", "", colnames(z))
colnames(z) <- gsub("Rate.the.following.items", "", colnames(z))
colnames(z) <- gsub("Rate.the.support.received.on.the.following.issues.", "", colnames(z))
z <- z[complete.cases(z),]
spl <- sample.split(z[,36], SplitRatio = 0.7)
train <- z[spl,]
test <- z[!spl,]
lda.fit <- lda(C.4.Please.rate.overall.satisfaction.with.EM.course._ ~ ., data = train)
lda.fit
lda.fit
